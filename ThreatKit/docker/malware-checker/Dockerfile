FROM python:3.11-slim

# --- non-root user for safety ---
ARG USER=threat
ARG UID=1000
RUN useradd -m -u ${UID} ${USER}
USER ${USER}

WORKDIR /work

# --- python deps ---
COPY --chown=${USER}:${USER} requirements.txt /work/requirements.txt
RUN pip install --no-cache-dir -r /work/requirements.txt \
    && pip install --no-cache-dir "scikit-learn==1.7.2"

# --- your worker code ---
COPY --chown=${USER}:${USER} src/ /work/src/
CMD ["python", "/work/src/static_worker.py"]
