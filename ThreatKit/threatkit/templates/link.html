{% extends "base.html" %}
{% block title %}ThreatKit â€” URL Checker{% endblock %}
{% block content %}
<h1 class="h4">URL Scanner</h1>
<p class="text-secondary">Enter a URL to check for potential phishing indicators.</p>



<form method="POST" class="tk-card" autocomplete="off">
  <label for="pw" class="form-label">Enter a link to evaluate</label>
  <div class="input-group mb-3">
    <input
      id="lk"
      name="url"
      type="url"
      class="form-control tk-input"
      placeholder="https://example.com"
      required
      minlength="1"
      aria-describedby="pwHelp"
    />
    <button class="btn btn-accent" type="submit">Scan</button>
</div>







{% if report %}
<hr>
<h5>Results for: <span>{{ report.url }}</span></h5>
<p><strong>Suspicious Score:</strong> {{ report.score }} / {{ report.results|length }}</p>

<ul class="list-group mt-3">
    {% for check in report.results %}
    <li class="list-group-item {% if check.triggered %}list-group-item-danger{% else %}list-group-item-success{% endif %}">
        <strong>{{ check.name }}</strong><br>
        {% if check.triggered %}
        {{ check.reason }}<br>
        <small class="text-muted">{{ check.reference }}</small>
        {% else %}
        <small class="text-muted">No issues detected.</small>
        {% endif %}
    </li>
    {% endfor %}
</ul>
{% endif %}
{% if ai_summary %}
<hr>
<h5>AI Analysis Summary</h5>
<div class="alert alert-info" style="white-space: pre-wrap;">{{ ai_summary }}</div>
{% endif %}
{% endblock %}