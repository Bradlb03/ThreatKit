{% extends "base.html" %}
{% block title %}ThreatKit — Password Checker{% endblock %}
{% block content %}
<h1 class="h4 mb-3">Password Checker</h1>

<!-- Post back to the same URL -->
<form method="POST" class="tk-card" autocomplete="off">
  <label for="pw" class="form-label">Enter a password to evaluate</label>
  <div class="input-group mb-3">
    <input
      id="pw"
      name="password"
      type="password"
      class="form-control tk-input"
      placeholder="CorrectHorseBatteryStaple"
      required
      minlength="4"
      aria-describedby="pwHelp"
    />
    <button class="btn btn-accent" type="submit">Submit</button>
  </div>
  <div id="pwHelp" class="form-text tk-subtle">
    We don’t store your password. It’s processed in memory only.
  </div>

{% if result %}
  <hr class="tk-sep my-3" />
  {% if result.error %}
    <div class="alert alert-danger">{{ result.error }}</div>
  {% else %}
    <div class="mt-2">
      <div class="fw-semibold">Score: {{ result.score }} / 4</div>
      <div class="tk-subtle">Estimated crack time: {{ result.crack_time_display }}</div>
      {% if result.warning %}
        <div class="mt-2 alert alert-warning">{{ result.warning }}</div>
      {% endif %}
      {% if result.suggestions %}
        <ul class="mt-2">
          {% for s in result.suggestions %}
            <li>{{ s }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
  {% endif %}
{% endif %}

</form>
{% endblock %}