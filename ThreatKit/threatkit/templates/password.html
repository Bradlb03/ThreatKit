{% extends "base.html" %}
{% from "components/score_meter.html" import score_meter %}
{% block title %}ThreatKit — Password Checker{% endblock %}

{% block content %}
<h1 class="h4 mb-3">Password Checker</h1>

<form method="POST" class="tk-card" autocomplete="off">
  <label for="pw" class="form-label">Enter a password to evaluate</label>
  <div class="input-group mb-3">
    <input
      id="pw"
      name="password"
      type="password"
      class="form-control tk-input"
      placeholder="CorrectHorseBatteryStaple"
      required
      minlength="4"
      aria-describedby="pwHelp"
    />
    <button class="btn btn-accent" type="submit">Scan</button>
  </div>
  <div id="pwHelp" class="form-text tk-subtle">
    We don’t store your password. It’s processed in memory only.
  </div>

  {% if result %}
    <hr class="tk-sep my-3" />

    <div class="row g-4">
      <div class="col-md-6">
        <div class="tk-card">
          {{ score_meter(result.score, 5, result.label) }}
        </div>
      </div>

      <div class="col-md-6">
        <div class="tk-card">
          <div class="fw-semibold mb-2">Suggestions</div>
          <ul class="mb-0 tk-subtle">
            {% if result.suggestions and result.suggestions|length %}
              {% for s in result.suggestions %}
                <li>{{ s }}</li>
              {% endfor %}
            {% else %}
              <li>Use multiple unrelated words</li>
              <li>Avoid repeats and keyboard walks</li>
              <li>Aim for a score of 4–5</li>
            {% endif %}
            {% if result.warning %}<li><strong>Warning:</strong> {{ result.warning }}</li>{% endif %}
          </ul>
        </div>
      </div>
    </div>

    <div class="tk-card mt-4">
      <ul class="nav tabs" role="tablist">
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#p-sum" type="button">Summary</button></li>
      </ul>
      <div class="tab-content pt-3">
        <div id="p-sum" class="tab-pane fade show active tk-subtle">
          {{ result.label }} (score {{ result.score }}/5) — {{ result.crack_time_display }}
        </div>
        <div id="p-det" class="tab-pane fade tk-subtle">
          {% if result.reasons and result.reasons|length %}
            Address the issues listed in “Top reasons.”
          {% else %}
            Looks good. Consider using a password manager and unique passwords.
          {% endif %}
        </div>
        <div id="p-json" class="tab-pane fade">
          <code class="tk-subtle">{{ result | tojson }}</code>
        </div>
      </div>
    </div>
  {% endif %}
</form>
{% endblock %}
