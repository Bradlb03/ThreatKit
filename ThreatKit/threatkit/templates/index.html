{% extends "base.html" %}
{% block title %}ThreatKit — Home{% endblock %}

{% block content %}

<div class="row g-4 align-items-stretch">

  <!-- LEFT SIDE — HERO -->
  <div class="col-12 col-lg-8">
    <section class="tk-card h-100">
      <div class="d-flex justify-content-between align-items-start mb-3">
        <div>
          <div class="tk-hero-title">
            Understand <span style="color:#93c5fd">why</span> something is risky.
          </div>

          <p class="tk-subtle mb-3">
            ThreatKit explains decisions with clear reasons and privacy-first design across
            Password, URL, Phishing, and Malware modules.
          </p>

          <div class="d-flex gap-2">
            <a href="/link" class="btn btn-accent">Scan a URL</a>
            <a href="/password" class="btn btn-outline-light">Test a Password</a>
          </div>
        </div>

        <div class="tk-card" style="min-width:260px;">
          <div class="fw-semibold mb-2">How scoring works</div>
          <ul class="tk-subtle mb-0 small">
            <li>Quick, explainable checks</li>
            <li>Easy Risk Score Display</li>
            <li>Super Easy to Use!</li>
          </ul>
        </div>
      </div>
    </section>
  </div>

  <!-- RIGHT SIDE — WALKTHROUGH VIDEO -->
  <div class="col-12 col-lg-4">
    <section class="tk-card h-100 position-relative p-3">

      <!-- Walkthrough Title -->
        <div class="tk-hero-title mb-3" style="font-size:1.4rem; line-height:1.2;">
        <span>Quick Demo</span>
        </div>


      <div class="d-flex align-items-center justify-content-center position-relative" style="width:100%;">

        <!-- Video -->
        <video id="demoVideo"
          src="{{ url_for('static', filename='media/ThreatKitDemo.mov') }}"
          playsinline
          style="
            width:100%;
            border-radius:12px;
            box-shadow:0 4px 18px rgba(0,0,0,0.45);
            cursor:pointer;
          "
          onclick="toggleVideo()">
        </video>

        <!-- Play Button Overlay -->
        <div id="playButton"
          onclick="toggleVideo()"
          style="
            position:absolute;
            width:80px;
            height:80px;
            background:rgba(255,255,255,0.1);
            backdrop-filter:blur(6px);
            border:1px solid rgba(255,255,255,0.2);
            border-radius:50%;
            display:flex;
            align-items:center;
            justify-content:center;
            cursor:pointer;
            transition:opacity .2s;
          ">
          <svg width="32" height="32" viewBox='0 0 24 24' fill='white'>
            <path d='M8 5v14l11-7z'></path>
          </svg>
        </div>

        <!-- Progress Bar -->
        <div style="
          position:absolute;
          left:16px;
          right:60px;
          bottom:16px;
        ">
          <input
            id="videoProgress"
            type="range"
            min="0"
            max="100"
            value="0"
            step="0.1"
            style="
              width:100%;
              height:4px;
              cursor:pointer;
              background:rgba(255,255,255,0.1);
            ">
        </div>

        <!-- Fullscreen Button -->
        <div id="fullscreenBtn"
          onclick="openFullscreen()"
          style="
            position:absolute;
            bottom:8px;
            right:16px;
            width:28px;
            height:28px;
            display:flex;
            align-items:center;
            justify-content:center;
            cursor:pointer;
            background:rgba(255,255,255,0.1);
            border-radius:6px;
            border:1px solid rgba(255,255,255,0.2);
            transition:0.2s;
          ">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="white">
            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zm-3-12v2h3v3h2V5h-5z"/>
          </svg>
        </div>
      </div>

    </section>
  </div>

</div>

<!-- VIDEO SCRIPT -->
<script>
  var video      = document.getElementById("demoVideo");
  var playBtn    = document.getElementById("playButton");
  var progress   = document.getElementById("videoProgress");

  function toggleVideo() {
    video.muted = false;
    video.volume = 1.0;

    if (video.paused) {
      video.play();
      playBtn.style.opacity = "0";
      setTimeout(() => playBtn.style.display = "none", 200);
    } else {
      video.pause();
      playBtn.style.display = "flex";
      setTimeout(() => playBtn.style.opacity = "1", 10);
    }
  }

  video.addEventListener("timeupdate", function () {
    if (!video.duration) return;
    var percent = (video.currentTime / video.duration) * 100;
    progress.value = percent;
  });

  progress.addEventListener("input", function () {
    if (!video.duration) return;
    var newTime = (progress.value / 100) * video.duration;
    video.currentTime = newTime;
  });

  function openFullscreen() {
    if (video.requestFullscreen) {
      video.requestFullscreen();
    } else if (video.webkitEnterFullscreen) {
      video.webkitEnterFullscreen();
    }
  }
</script>

{% endblock %}
