rule TEST_Packed_UPX_or_ASPack {
  strings:
    $upx1 = "UPX!" nocase
    $upx2 = ".UPX" nocase
    $aspack1 = "ASPack" nocase
    $aspack2 = ".aspack" nocase
  condition:
    any of them
}

rule TEST_Suspicious_Win32_APIs {
  strings:
    $crt = "CreateRemoteThread"
    $va  = "VirtualAlloc"
    $wtm = "WriteProcessMemory"
    $gpa = "GetProcAddress"
    $ll  = "LoadLibraryA"
  condition:
    2 of them
}

rule TEST_Malware_Keywords {
  strings:
    $k1 = "hacktool" nocase
    $k2 = "\\AppData\\Roaming\\" nocase
    $k3 = "\\Temp\\" nocase
    $k4 = "keylogger" nocase
  condition:
    any of them
}