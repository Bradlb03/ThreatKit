import sys, json, hashlib, pathlib

def sha256(p):
    h = hashlib.sha256()
    with open(p, "rb") as f:
        for chunk in iter(lambda: f.read(8192), b""):
            h.update(chunk)
    return h.hexdigest()

if __name__ == "__main__":
    inp = pathlib.Path(sys.argv[1] if len(sys.argv) > 1 else "/work/input/sample.bin")
    out = pathlib.Path("/work/output/features.json")
    out.parent.mkdir(parents=True, exist_ok=True)
    result = {"file": inp.name, "sha256": sha256(inp)}
    out.write_text(json.dumps(result, indent=2))
    print(f"Wrote {out}")

